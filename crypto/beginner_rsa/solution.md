# Beginner RSA

```Python3
from Crypto.Util.number import long_to_bytes, bytes_to_long, getPrime
from secret import flag

p, q = getPrime(512), getPrime(512)
n = p*q
e = 65537
c = pow(bytes_to_long(flag), e, n)
hint = p - q

print(f'{n = }')
print(f'{c = }')
print(f'{hint = }')

"""
n = 108101794838326543108895442568320595213435883352002970605393215931233377913234347860817207449734048854796921695401675819470608413896222201875034392774928170985401124602439808330499968640189486285009153051676697766845783397421232061096432544048255406387837608882706490251778496052040229361828035076446882520699
c = 97312039931204931670517983531024396868711163447332122691082888644181757421836790183057186847748747068503800986626497553799709106390947892733416432696750448598709299451805998449642510694711152435165407505544602791924544055316517252732481699437742538680421980944988259576865417606246443971513575523530399766421
hint = -45798202670934881090341150514048793180781007412870732590073349554550770488341780373075166862417201752345856750756903792702161344242442217759876646244710
"""
```

<br/>We are given an RSA encryption algorithm code snippet as above. To decrypt the message we need to find `p` and `q`. We can rewrite `hint = p - q` as `p = q + hint` and substitute in `n = p * q` to get `q * (q + hint) = n`, a quadratic equation in `q`. We can solve this equation using the standard formula or let Sage do it for you.<br/>

```Sage
n = 108101794838326543108895442568320595213435883352002970605393215931233377913234347860817207449734048854796921695401675819470608413896222201875034392774928170985401124602439808330499968640189486285009153051676697766845783397421232061096432544048255406387837608882706490251778496052040229361828035076446882520699
hint = -45798202670934881090341150514048793180781007412870732590073349554550770488341780373075166862417201752345856750756903792702161344242442217759876646244710

solve([x**2 + hint*x - n == 0], x)
```
```Sage
[x == 10420125616477306703464911499436119516592074278384331960862146209614711130849180309579775409800535111782897815370320126919480081521267649925152853274087437, x == -10374327413806371822374570348922070723411293270971461228272072860060160360360838529206700242938117910030551958619563223126777920177025207707392976627842727]
```
<br/>We get the following solutions for q, and we take the positive root for `q`. We then calculate `p = n // q` and proceed to decrypt the message.

```Python3
from Crypto.Util.number import bytes_to_long, long_to_bytes

n = 108101794838326543108895442568320595213435883352002970605393215931233377913234347860817207449734048854796921695401675819470608413896222201875034392774928170985401124602439808330499968640189486285009153051676697766845783397421232061096432544048255406387837608882706490251778496052040229361828035076446882520699
c = 97312039931204931670517983531024396868711163447332122691082888644181757421836790183057186847748747068503800986626497553799709106390947892733416432696750448598709299451805998449642510694711152435165407505544602791924544055316517252732481699437742538680421980944988259576865417606246443971513575523530399766421
q = 10420125616477306703464911499436119516592074278384331960862146209614711130849180309579775409800535111782897815370320126919480081521267649925152853274087437
p = n // q
phi = (p - 1) * (q - 1)
e = 65537
d = pow(e, -1, phi)
flag = pow(c, d, n)
print(long_to_bytes(flag))
```

## Flag
  ```
  blahaj{eqns_and_rsa_make_a_fine_couple}
  ```
